[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "psci3200-final-koung",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n1 + 1 + 1 \n\n[1] 3"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "PSCI3200FinalProjectResearchDesign.html",
    "href": "PSCI3200FinalProjectResearchDesign.html",
    "title": "PSCI 3200 Final Project Research Design",
    "section": "",
    "text": "Task 1:\nDescribe your research question and provide some background on why you find it interesting or important. Be sure to incorporate the feedback provided on the first assignment. Include references to at least two pieces of existing research that illustrate what has already been discovered about the relationship you are investigating. This could be articles published in academic journals, policy reports and white papers, articles published by think tanks and other credible organizations (ex. Brookings, the United Nations High Commissioner for Refugees, etc.), or pieces of data journalism. A full-credit response will probably be around 150-200 words. (40%)\n\nDescription of research question, background, and why its a personal interest:\nThe research question explores the impact of LGBTQ+ rights and inclusion on a country’s tourism industry. This inquiry is motivated by observations and claims that countries with more inclusive LGBTQ+ rights may attract more tourists, thus benefiting economically. The relevance of this question extends beyond economic considerations, touching on global development issues and the social progress embodied in the UN’s Sustainable Development Goals, particularly SDG 10 on reducing inequalities. Recent legislative changes, such as those in Uganda, and their potential economic repercussions highlight the urgency of understanding this dynamic. The study aims to quantitatively measure the relationship between LGBTQ+ rights—using indices like the Spartacus Gay Travel Guide—and tourism metrics, offering insights into how inclusivity influences economic outcomes.\nOn a more personal level, as an LGBTQ person, when thinking about programs available to me as a student at Penn, such as Penn Global Seminars, study abroad programs, and Global Research and Internship Programs, I have had to consider the countries I would be able to safely live and work in. Having spent a lot of time at the intersection of LGBTQ+ policy and business I often hear about the business impact and I feel this is one way in which I could contribute to broader findings, as I have not found any explicit research connected to the relationship between tourism and LGBTQ+ friendliness.\nPotential sources that cover this topic:\nTitle: LGBT tourist decision-making and behaviours. A study of Millennial Italian tourists (link)\nAuthor: Salvatore Monaco\nJournal: International Journal of Sociology and Social Policy\nDate: 11 August 2022\nThe study investigates how Italian LGBT Millennials make travel decisions, emphasizing the influence of ‘push’ and ‘pull’ factors on their destination choices. Utilizing an online survey distributed through social networks and LGBTQ+ community platforms, it provides insights into the preferences and motivations behind their travel behaviors. This research is relevant as it proves there are specific needs and considerations of LGBT tourists, offering a perspective on how inclusive policies and societal attitudes might impact tourism choices.\nTitle: The Relationship Between LGBT Inclusion and Economic Development: Emerging Economies (link)\nAuthors: M.V. Lee Badgett, Sheila Nezhad, Kees Waaldijk, Yana van der Meulen Rodgers\nInstitution: Williams Institute at UCLA\nDate: November 2014\nThis comprehensive study explores the correlation between the social inclusion of LGBT individuals and economic development across 39 countries. The research employs both micro and macro-level analyses to examine the impact of LGBT inclusion on a country’s economic performance. Findings indicate a positive relationship between the degree of legal rights granted to LGBT individuals and economic indicators such as GDP per capita. The study provides empirical evidence supporting the notion that greater LGBT inclusion is associated with stronger economic outcomes, emphasizing the importance of anti-discrimination laws and their direct economic relevance. This research contributes significantly to understanding the economic implications of LGBT rights and inclusion on a global scale. While not specifically related to tourism, this research could serve as a model to follow/base my research off of.\n\n\n\nTask 2:\nState at least one testable hypothesis. Distill your research question into a statement about a specific relationship you expect to see in the world. In most cases, this hypothesis will describe a causal relationship between two variables (i.e. changes in x cause changes in y). Make an argument for why you expect to see this relationship. This should be based on related findings from existing research and/or your own theoretical/logical reasoning. A full-credit response will probably be around 150-200 words. (25%)\n\nPossible hypothesis\nDecreases in LGBTQ friendliness variables that hinder tourism in a given country will result in a decrease in tourism volume to the country, as measured by number of arrivals.\nWhy?\nAs I have discussed in Checkpoint 1 and above, there is often lots of activists that claim that it is actually costly to countries that are anti-lgbtq because they lose money from tourism and more. As the research iI cited in task 1, the Badgett et al. piece clearly demonstrates how LGBTQ friendliness has an effect on the economy. Secondly, in the first piece of research (as well as a few other older studies show) we know that LGBTQ people consider such factors when traveling, with some research saying LGBTQ friendliness has stronger effects than recent terrorism in the country. Anyway, theoretically less people in the LGBTQ communities should be likely to travel to a place after it has regressed on LGBTQ friendliness. The vise versa should also be true. As countries become more supportive of LGBTQ communities I would expect that more lgbtq people would be willing to travel there and thereby effect tourism volume.\nPlease feel free to skip these next few code segements and just use the table of contents to skip to the top of Task3!\n\nlibrary(tidyverse)\n\ntour_dat_import &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/API_ST/API_ST.INT.ARVL_DS2_en_csv_v2_84029.csv\", \n                     #row 4 is headers\n                     skip = 3)\n\n##clean up data \n#no data between 1960 and 94 \nyrs_to_drop &lt;- as.character(1960:2011)\n\ntour_dat &lt;- tour_dat_import %&gt;%\n  select(-yrs_to_drop) %&gt;% \n  ##these years are mostly empty and I am going to not use post-covid data cause the metrics for LGBT measures changed slighty from 2020 onward \n  select(-\"2020\") %&gt;% \n  select(-\"2021\") %&gt;% \n  select(-\"2022\") %&gt;% \n  select(-\"2023\") %&gt;% \n  select(-\"...69\") %&gt;% \n  select(-\"Country Code\") %&gt;% \n  select(-\"Indicator Code\") %&gt;% \n  select(-\"Indicator Name\")\n\n##import gay travel\ngay_2012 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2012.csv\", \n                     skip = 1) %&gt;% \n  #dropping to only country rows\n  slice(1:145) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(!is.na(Total)) %&gt;% \n  filter(Total != \"Total\")\n\ngay_2012_cleaned &lt;- gay_2012 %&gt;%\n  rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country)) %&gt;% \n  mutate(Year = 2012) %&gt;% \n  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %&gt;% \n  mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2012_cleaned)\n\ngay_2013 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2013.csv\", \n                     skip = 1) %&gt;% \n  #dropping to only country rows\n  slice(1:145) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(!is.na(Total)) %&gt;% \n  filter(Total != \"Total\")\n\ngay_2013_cleaned &lt;- gay_2013 %&gt;%\n  rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country))  %&gt;% \n  mutate(Year = 2013) %&gt;% \n  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %&gt;% \n  mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2013_cleaned)\n\n\ngay_2014 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2014.csv\", \n                     skip = 1) %&gt;% \n  rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  #slice(1:145) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2014_cleaned &lt;- gay_2014 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country))  %&gt;% \n  mutate(Year = 2014) %&gt;% \n  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %&gt;% \n  mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2014_cleaned)\n\n\ngay_2015 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2015.csv\", \n                     skip = 1) %&gt;% \n  #rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  slice(1:210) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2015_cleaned &lt;- gay_2015 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country)) %&gt;% \n  mutate(Year = 2015) %&gt;% \n  rename('Marriage / Partnership' = `Marriage /\nCivil Partnership`, \n         \"Religious influence\" = `Religious Influence`, \n         \"Anti-gay laws\" = `Anti-Gay Laws`, \n         \"HIV-travel restrictions\" = `HIV Travel Restrictions`,\n         \"Anitdiscrimination\" = `Antidiscrimination legislation`) %&gt;% \n  mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2015_cleaned)\n\n\ngay_2016 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2016.csv\", \n                     skip = 1) %&gt;% \n  #rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  slice(1:204) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2016_cleaned &lt;- gay_2016 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country))  %&gt;% \n  mutate(Year = 2016) %&gt;% \n  rename('Marriage / Partnership' = `Marriage /\nCivil Partnership`, \n\"Religious influence\" = `Religious Influence`, \n\"Anitdiscrimination\" = `Antidiscrimination legislation`, \n\"Anti-gay laws\" = `Anti-Gay Laws`, \n         \"HIV-travel restrictions\" = `HIV Travel Restrictions`) %&gt;% \n    mutate(across(-c(Country), as.numeric))\n\n\ncolnames(gay_2016_cleaned)\n\n\ngay_2017 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2017.csv\", \n                     skip = 1) %&gt;% \n  #rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  slice(1:207) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2017_cleaned &lt;- gay_2017 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country))  %&gt;% \n  mutate(Year = 2017) %&gt;% \n  rename('Marriage / Partnership' = `Marriage /\nCivil Partnership`, \n\"Religious influence\" = `Religious Influence`, \n\"Anitdiscrimination\" = `Antidiscrimination legislation`, \n\"Anti-gay laws\" = `Anti-Gay Laws`, \n         \"HIV-travel restrictions\" = `HIV Travel Restrictions`) %&gt;% \n    mutate(across(-c(Country), as.numeric))\n\n\ncolnames(gay_2017_cleaned)\n\ngay_2018 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2018.csv\", \n                     skip = 186) %&gt;% \n  #rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  #slice(1:230) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2018_cleaned &lt;- gay_2018 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country))  %&gt;% \n  mutate(Year = 2018) %&gt;% \n  rename('Marriage / Partnership' = `Mariage /`, \n         \"Equal Age of Consent\" = `Equal Age of`, \n         \"Homosexuality illegal\" = Homosexuality, \n         \"Religious influence\" = Religious, \n         \"Anti-gay laws\" = `Anti-Gay Laws`, \n         \"HIV-travel restrictions\" = `HIV Travel`) %&gt;% \n    mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2018_cleaned)\n\n\ngay_2019 &lt;- read_csv(\"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2019.csv\") %&gt;% \n  #rename(\"Country\" = \"...2\") %&gt;% \n  #dropping to only country rows\n  #slice(1:230) %&gt;% \n  #dropping empty cols \n  select(-matches(\"^\\\\.\\\\.\\\\.[0-9]+$\")) %&gt;% \n  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or \"Total\" indicates its headers\n  filter(Total != \"Total\")\n\ngay_2019_cleaned &lt;- gay_2019 %&gt;%\n  #rename('Country' = 'Gay Travel Index') %&gt;% \n  mutate(Country = str_replace(Country, \"[0-9]+$\", \"\")) %&gt;% \n  mutate(Country = toupper(Country)) %&gt;% \n  mutate(Year = 2019) %&gt;% \n  rename('Marriage / Partnership' = `Mariage /`, \n         \"Equal Age of Consent\" = `Equal Age of`, \n         \"Homosexuality illegal\" = Homosexuality, \n         \"Religious influence\" = Religious, \n         \"Anti-gay laws\" = `Anti-Gay Laws`, \n         \"HIV-travel restrictions\" = `HIV Travel`) %&gt;% \n    mutate(across(-c(Country), as.numeric))\n\ncolnames(gay_2019_cleaned)\n\n\n## now lets work on binding the dataframes  \n\nall_yrs_gay &lt;- bind_rows(gay_2012_cleaned,\n                         gay_2013_cleaned, \n                         gay_2014_cleaned, \n                         gay_2015_cleaned, \n                         gay_2016_cleaned, \n                         gay_2017_cleaned, \n                         gay_2018_cleaned, \n                         gay_2019_cleaned)\n\ndim(all_yrs_gay)\n\nwrite.csv(all_yrs_gay, \"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /all_yrs_gay.csv\", row.names = FALSE)\n\n\nlibrary(readr)\nlibrary(stats) \n\nall_yrs_gay_pca &lt;- all_yrs_gay %&gt;% \n  select(-c(Total, Country, Year, `Trans Gender Rights`)) %&gt;% \n  na.omit()\n\n# Step 3: Perform PCA\npca_result &lt;- prcomp(all_yrs_gay_pca, scale. = TRUE)\n\n# Print summary of PCA results\nsummary(pca_result)\n\nImportance of components:\n                          PC1    PC2     PC3     PC4     PC5     PC6     PC7\nStandard deviation     2.2447 1.2785 1.06022 1.05163 0.97546 0.93039 0.84649\nProportion of Variance 0.3599 0.1168 0.08029 0.07899 0.06797 0.06183 0.05118\nCumulative Proportion  0.3599 0.4767 0.55696 0.63595 0.70392 0.76575 0.81693\n                           PC8     PC9    PC10    PC11    PC12   PC13    PC14\nStandard deviation     0.81537 0.75664 0.64350 0.57626 0.49451 0.4427 0.37267\nProportion of Variance 0.04749 0.04089 0.02958 0.02372 0.01747 0.0140 0.00992\nCumulative Proportion  0.86442 0.90531 0.93489 0.95861 0.97608 0.9901 1.00000\n\n# Optional: Plot PCA\nplot(pca_result$x[,1:2], pch = 19, xlab = \"PC1\", ylab = \"PC2\") + \ntitle(\"PCA Plot\")\n\n\n\n\n\n\n\n\ninteger(0)\n\n# Scree Plot\nplot(pca_result$sdev^2 / sum(pca_result$sdev^2), \n     xlab = \"Principal Component\", \n     ylab = \"Proportion of Variance Explained\", \n     type = 'b', \n     pch = 19, \n     main = \"Scree Plot\")\n\n# Adding a cumulative sum line to the scree plot\ncumulative_variance &lt;- cumsum(pca_result$sdev^2 / sum(pca_result$sdev^2))\nlines(cumulative_variance, col = \"blue\", type = 'b', pch = 18)\nlegend(\"topright\", legend = c(\"Variance\", \"Cumulative Variance\"), col = c(\"black\", \"blue\"), pch = c(19, 18), lty = 1)\n\n\n\n\n\n\n\n\nLooks like the cut off is 3\n\nscores &lt;- pca_result$x[, 1:3]\nhead(scores, 18)\n\nloadings &lt;- pca_result$rotation[, 1:3]\nprint(loadings)\n\nlets try a corr matrix\n\ncor_matrix &lt;- cor(all_yrs_gay_pca, use = \"pairwise.complete.obs\")\n\n# Install and load necessary packages\nif (!requireNamespace(\"igraph\", quietly = TRUE)) install.packages(\"igraph\")\nif (!requireNamespace(\"ggraph\", quietly = TRUE)) install.packages(\"ggraph\")\nlibrary(igraph)\n\nWarning: package 'igraph' was built under R version 4.2.3\n\n\n\nAttaching package: 'igraph'\n\n\nThe following objects are masked from 'package:lubridate':\n\n    %--%, union\n\n\nThe following objects are masked from 'package:dplyr':\n\n    as_data_frame, groups, union\n\n\nThe following objects are masked from 'package:purrr':\n\n    compose, simplify\n\n\nThe following object is masked from 'package:tidyr':\n\n    crossing\n\n\nThe following object is masked from 'package:tibble':\n\n    as_data_frame\n\n\nThe following objects are masked from 'package:stats':\n\n    decompose, spectrum\n\n\nThe following object is masked from 'package:base':\n\n    union\n\nlibrary(ggraph)\n\ngraph &lt;- graph_from_adjacency_matrix(cor_matrix, weighted = TRUE, mode = \"undirected\", diag = FALSE)\nthreshold &lt;- 0.5  # Example threshold\ngraph &lt;- delete_edges(graph, E(graph)[abs(E(graph)$weight) &lt; threshold])\n\n# Create the network plot\nggraph(graph, layout = 'fr') + \n  geom_edge_link(aes(edge_alpha = abs(weight), edge_width = abs(weight)), edge_color = \"grey\") +\n  geom_node_point(color = \"darkblue\", size = 5) +\n  geom_node_text(aes(label = name), repel = TRUE) +\n  theme_graph() +\n  ggtitle(\"Variable Correlation Network\")\n\nWarning: The `trans` argument of `continuous_scale()` is deprecated as of ggplot2 3.5.0.\nℹ Please use the `transform` argument instead.\n\n\nWarning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.\n\n\n\n\n\n\n\n\n\nThere is a ton of NA’s in the data set and before deciding what do to on that front, let me see what countries we have tourist data for. We can cut out countries that dont exist in that data set.\n\n#lets look for mergining \ntour_dat_cleaned &lt;- tour_dat %&gt;% \n  mutate(Country = toupper(`Country Name`)) %&gt;% \n  select(-`Country Name`)\n\n\n#lets now check by NA's \ntour_dat_cleaned$NA_count = rowSums(is.na(tour_dat_cleaned[, -which(names(tour_dat_cleaned) == \"Country\")]))\n\ntour_dat_NA_count = tour_dat_cleaned[, c(\"Country\", \"NA_count\")] %&gt;% arrange(desc(NA_count))\nprint(tour_dat_NA_count)\n\n## we know for certain we can drop countries that have 7 or 8 NA's because we cant make any over year effect \ntour_dat_cleaned &lt;- tour_dat_cleaned %&gt;% \n  filter(NA_count &lt; 7) \n\ndim(tour_dat_cleaned)\n\nwrite.csv(tour_dat_cleaned, \"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /tour_dat_cleaned.csv\", \n          row.names = FALSE)\n\nLets hold off on any more removing for now and work on pivoting the gay data wider so its at the country level\n\nall_yrs_gay_wide &lt;- all_yrs_gay %&gt;% \n  pivot_longer(cols = -c(Country, Year), names_to = \"Variable\", values_to = \"Value\") %&gt;%\n  unite(\"Variable_Year\", Variable, Year, sep = \"_\") %&gt;%\n  pivot_wider(names_from = \"Variable_Year\", values_from = \"Value\") %&gt;% \n  mutate(across(-Country, ~as.numeric(as.character(.))))\n  \n\nwrite.csv(all_yrs_gay_wide, \"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /all_yrs_gay_wide.csv\", \n          row.names = FALSE)\n\ndim(all_yrs_gay_wide)\n\nNow we have the super fun task of merging the data frames when the country names are very different! Using GPT 4 to help assist on making easy name/spelling matches\n\ntour_dat_new_country_names &lt;- tour_dat_cleaned %&gt;% \n  mutate(Country = case_when(\n    Country == \"ANTIGUA AND BARBUDA\" ~ \"ANTIGUA & BARBUDA\",\n    Country == \"BAHAMAS, THE\" ~ \"BAHAMAS\",\n    Country == \"BOSNIA AND HERZEGOVINA\" ~ \"BOSNIA-HERZEGOVINA\",\n    Country == \"BRUNEI DARUSSALAM\" ~ \"BRUNEI\",\n    Country == \"CONGO, DEM. REP.\" ~ \"DEM. REP. OF CONGO\",\n    Country == \"CONGO, REP.\" ~ \"REP. OF THE CONGO\",\n    Country == \"COTE D'IVOIRE\" ~ \"IVORY COAST\",\n    Country == \"CZECHIA\" ~ \"CZECH REPUBLIC\",\n    Country == \"EGYPT, ARAB REP.\" ~ \"EGYPT\",\n    Country == \"ESWATINI\" ~ \"SWAZILAND\",\n    Country == \"IRAN, ISLAMIC REP.\" ~ \"IRAN\",\n    Country == \"KOREA, REP.\" ~ \"KOREA SOUTH\",\n    Country == \"KYRGYZ REPUBLIC\" ~ \"KYRGYZSTAN\",\n    Country == \"LAO PDR\" ~ \"LAOS\",\n    Country == \"NORTH MACEDONIA\" ~ \"MACEDONIA\",\n    Country == \"RUSSIAN FEDERATION\" ~ \"RUSSIA\",\n    Country == \"SLOVAK REPUBLIC\" ~ \"SLOVAKIA\",\n    Country == \"SYRIAN ARAB REPUBLIC\" ~ \"SYRIA\",\n    Country == \"TURKIYE\" ~ \"TURKEY\",\n    Country == \"VENEZUELA, RB\" ~ \"VENEZUELA\",\n    Country == \"VIET NAM\" ~ \"VIETNAM\",\n    Country == \"YEMEN, REP.\" ~ \"YEMEN\",\n    Country == \"UNITED STATES\" ~ \"USA\",\n    Country == \"MACAO SAR, CHINA\" ~ \"MACAO\", # Assuming direct equivalence\n    Country == \"ST. KITTS AND NEVIS\" ~ \"SAINT KITTS & NEVIS\",\n    Country == \"ST. LUCIA\" ~ \"SAINT LUCIA\",\n    Country == \"ST. VINCENT AND THE GRENADINES\" ~ \"SAINT VINCENT & THE GRENADINES\",\n    Country == \"GAMBIA, THE\" ~ \"GAMBIA\",\n    Country == \"COMOROS\" ~ \"COMOROS ISLANDS\",\n    Country == \"CENTRAL AFRICAN REPUBLIC\" ~ \"CENTRAL AFRICAN REP.\",\n    Country == \"VIRGIN ISLANDS (USA)\" ~ \"VIRGIN ISLANDS\",\n    TRUE ~ Country)) \n\nSo now before we can merge I should try to bring in the percent changes\n\ndataframe &lt;- all_yrs_gay_wide\n\nfor(year in 2012:2018) {\n  # Generate the names of the columns for the current year and the next year\n  current_year_cols &lt;- grep(paste0(\"_\", year, \"$\"), names(dataframe), value = TRUE)\n  next_year_cols &lt;- sub(year, year + 1, current_year_cols)\n  \n  # For each column corresponding to the current year\n  for(i in 1:length(current_year_cols)) {\n    current_col &lt;- current_year_cols[i]\n    next_col &lt;- next_year_cols[i]\n    \n    # Check if next_col exists in the dataframe\n    if(next_col %in% names(dataframe)) {\n      # Adjusting the naming convention as per the new requirement\n      change_col_name &lt;- sub(\"_\\\\d+$\", paste0(\"__pt.\", year + 1), current_col)\n      \n      # Calculate the additive change and add it as a new column\n      dataframe[[change_col_name]] = dataframe[[next_col]] - dataframe[[current_col]]\n    }\n  }\n}\n\ndim(dataframe)\n\n\n#now select only the vars representing change \ngay_changes_wide &lt;- dataframe %&gt;% \n  select(which(grepl(\"__\", names(dataframe))) | \"Country\")\n\ndim(gay_changes_wide)\n\nwrite.csv(gay_changes_wide, \"/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gay_changes_wide.csv\", row.names = FALSE)\n\nNow pivot longer again\n\ngay_changes_long &lt;- gay_changes_wide %&gt;%\n  gather(key = \"Year_Variable\", value = \"Value\", -Country) %&gt;%\n  mutate(Year = gsub(\".*pt\\\\.(\\\\d+)\", \"\\\\1\", Year_Variable),\n         Variable = gsub(\"(.*)__pt\\\\..*\", \"\\\\1\", Year_Variable),\n         Variable = gsub(\"_\", \" \", Variable)) %&gt;%\n  select(-Year_Variable) %&gt;%\n  spread(key = Variable, value = Value)\n\ndim(gay_changes_long)\n\nNow lets set up the tourism data so its % change\n\nyrs_to_drop_tour &lt;- as.character(2012:2019)\n\ntour_dat_pct &lt;- tour_dat_new_country_names %&gt;%\n  mutate(`2013.pct` = (`2013` - `2012`) / `2012` * 100,\n         `2014.pct` = (`2014` - `2013`) / `2013` * 100,\n         `2015.pct` = (`2015` - `2014`) / `2014` * 100,\n         `2016.pct` = (`2016` - `2015`) / `2015` * 100,\n         `2017.pct` = (`2017` - `2016`) / `2016` * 100,\n         `2018.pct` = (`2018` - `2017`) / `2017` * 100,\n         `2019.pct` = (`2019` - `2018`) / `2018` * 100) %&gt;% \n  select(-all_of(yrs_to_drop_tour)) %&gt;% \n  select(-NA_count)\n\nNow lets put it so its long by country year\n\ntour_dat_pct_long &lt;- tour_dat_pct %&gt;%\n  pivot_longer(\n    cols = -Country, \n    names_to = \"Year\",\n    values_to = \"tour_pct\",\n    names_pattern = \"(\\\\d{4}).*\")\n\nFinally, merge the df so it becomes COUNTRY, VAR_2012, VAR_2013… 2012 (tourism etc)\n\ndat_all &lt;- merge(gay_changes_long, tour_dat_pct_long, by=c(\"Country\", \"Year\"))\n\n#check for duplicates \nduplicates &lt;- dat_all[duplicated(dat_all[c(\"Country\", \"Year\")]) | duplicated(dat_all[c(\"Country\", \"Year\")], fromLast = TRUE), ]\nprint(duplicates)\n\nNow I need to drop rows where either we dont have the tour data or the entire row of lgbt vars is NA\n\ncount(dat_all[is.na(dat_all$tour_pct), ]) ##Only 62 instances i feel ok about removing\n#print(dat_all[is.na(dat_all$tour_pct), ]) Used to see \n\n\ndat_all &lt;- dat_all%&gt;% \n  filter(!is.na(tour_pct))\n\nNow lets look at NA’s for the entire LGBT row\n\nnum_rows_all_NA &lt;- dat_all %&gt;%\n  select(-Country, -Year, - tour_pct) %&gt;%  # Exclude non-LGBT variables if necessary\n  apply(1, function(x) all(is.na(x))) %&gt;%\n  sum()  # Count the number of TRUEs, which indicate rows with all NAs\n\n# Print the total number of rows with all NA for LGBT variables\nprint(paste(\"Total number of rows with all LGBT variables as NA:\", num_rows_all_NA))\n\n## 202 not ideal but still ok\n\ndat_all_final &lt;- dat_all %&gt;%\n  slice(-num_rows_all_NA)\n\n\n\n\nTask 3:\nBriefly discuss the specific variables you will use to test your hypothesis and the dataset they are drawn from. Be sure to mention the source of the data (the organization or individuals that produced it), the unit of analysis, and the sample. Create a ggplot to visualize the relationship between the variables being used to test your hypothesis. The best method of visualizing this relationship will depend on the scale of your variables. Good methods to consider are scatter plots (for continuous variables), grouped bar charts (for ordinal or binary variables), and line graphs (for continuous variables with time-series). (25%)\n\nDiscussion of key variables\nDependent Variable\n\nTourism volume percent change from the previous year (tour_pct):\n\nThis represents tourism data collected from the world bank and the world tourism association. You can see in the above code segments how I cleaned, pivoteded, mutated, merged, and more to turn the data from country, year 1, year 2, year n, in which the values were the number of tourist arrivals in that year. Note I only use starting 2012 because of limits of the independent variable, and I don’t use anything after FY 2019 because of covid-related shocks. Final unit of analysis is by country and year. Sample is not just countries but also territories (ex: US Virgin Islands), regions (ex: MENA), and other buckets such as income buckets which I discarded.\n\n\nIndependent Variables\n\nTotal\n\nThis represents the total score a country gets in a given year from the Gay Spartacus Travel Index. Each country was scored starting 2012, on a variety of different features (see other variables). Scores centered around 0 and countries can either earn points or loose points. The GSTI cites a variety of different sources including IGLA, Rainbow Europe, the UN, and more.\nIn order to get this into a workable format I had to get PDFs to EXCLs to CSVs and then spend a lot of time cleaning the data, pivoting, merging re-poviting, etc. See above code segements for more specifics, but I got the unit of analysis down to country year, such that the df looks like: Country, Year, Total, Specific LGBT variable 1, Specific LGBT variable 2, Specific LGBT variable …n. Sample ranges specifically from year to year but generally includes UN-recognized countries.\n\n\nI only will cover a few examples because the process is the pretty similar for all of the LGBT variables since it comes from the same org and report.\n\nAdoption allowed\n\nThis is a pretty clear measure where its very simple to see whether or not adoption is allowed, and for the most part this functions as a binary variable.\n\nAntidiscrimination\n\n“With regard to anti-discrimination laws up to 3 points can be awarded, making a distinction, for example, whether the principle of non-discrimination on grounds of sexual orientation in the constitution or only in a law for a specific area is shown.” (direct wording from the GSTI).\n\n\n\nggplot(dat_all_final, \n       aes(x = as.factor(Total), \n           y = tour_pct)) + \n  geom_boxplot() + \n  labs(x = \"Total change in LGBTQ+ scores\", \n       y = \"Change in Tourism Arrivals by Volume\", \n       title = \"Does changes in LGBTQ friendliness impact tourism volume? No.\")\n\n\n\n\n\n\n\n\n\nggplot(dat_all_final, \n       aes(x = Total, \n           y = tour_pct)) + \n  geom_point() + \n  geom_smooth(method=lm) + \n  labs(x = \"Total change in LGBTQ+ scores\", \n       y = \"Change in Tourism Arrivals by Volume\", \n       title = \"Does changes in LGBTQ friendliness impact tourism volume? No.\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 205 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n\n\nWarning: Removed 205 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\n\n\n\nTask 4:\nSpecify the main regression model you will use to test your hypothesis. This regression model should provide a preliminary test for or against the validity of your hypothesis. Use markdown to render the equation neatly to the html file. (10%)\n\nAfter some discussion with you, I have decided that the simplest regression model is best. Because I am looking at percent change, there is an effect similar to FE that already controls for country size.\n\\[\nPercent\\ Change\\ Tourism\\ Volume_i = \\alpha + \\beta_1( Change\\ in\\ LGBTQ\\ Friendliness\\ Variables)_{i1} + \\epsilon_i\n\\]\nA note on AI\nI used GPT4 many times throughout this assignment. Noteably in helping me code in time saving measures (instead of calculating the percent change by hand for 12+ variables and over 9 times each) I got it to give me the code to do it automatically. Moreover, especially with the chaos that is pivoting I used it to help me ID rows using str type commands. I also used GPT4 to help with editing, debugging, trying to use python instead (did not go with in the end), as well as some editing/rephrasing and reworking of my explanations and responses."
  }
]