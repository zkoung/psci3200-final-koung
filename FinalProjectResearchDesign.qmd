---
title: "PSCI 3200 Final Project"
format:
  html:
    self-contained: TRUE 
    toc: TRUE
institute: "University of Pennsylvania" 
author: "Zach Koung"
editor: source
bibliography: /Users/zachkoung/Documents/GitHub/psci3200-final-koung/PSCI3200.bib
---

```{r}
#| output: false
#| include: false 

# A note on AI I used GPT4 many times throughout this assignment. Noteably in helping me code in time saving measures (instead of calculating the percent change by hand for 12+ variables and over 9 times each) I got it to give me the code to do it automatically. Moreover, especially with the chaos that is pivoting I used it to help me ID rows using str type commands. I also used GPT4 to help with editing, debugging, trying to use python instead (did not go with in the end), as well as some editing/rephrasing and reworking of my explanations and responses. Moreover, I used it to help brainstorm some potential confounders (was okay at doing it) and then also used it to help brainstorm remedies (was meh at it). I also used chat gpt to assign countries into regions using the specific naming I had so I wouldnt have to a lot more cleaning then I verified the regions to make sure it made sense. Also used it to draft the findings analysis (meh) and then spent time over it manually. Additioanlly, I had it help me write the concluding section by summing up the existing paper, i then went through and added individual other parts/reworked the order of some things but overall it was quite good at it. Also I used it substantially in the section on my hypothesis and theory, I gave it my going theory (the premesis) and then my hypothesis and the introduction whcih I wrote and I asked it to fill in the rest, and it did pretty good and just required minor edits! 

#bibliography: ./Users/zachkoung/Documents/GitHub/psci3200-final-koung/PSCI3200.bib

library(tidyverse)
library(dplyr)
library(gt)
library(knitr)
library(modelsummary)

tour_dat_import <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/API_ST/API_ST.INT.ARVL_DS2_en_csv_v2_84029.csv", 
                     #row 4 is headers
                     skip = 3)

##clean up data 
#no data between 1960 and 94 
yrs_to_drop <- as.character(1960:2011)

tour_dat <- tour_dat_import %>%
  select(-yrs_to_drop) %>% 
  ##these years are mostly empty and I am going to not use post-covid data cause the metrics for LGBT measures changed slighty from 2020 onward 
  select(-"2020") %>% 
  select(-"2021") %>% 
  select(-"2022") %>% 
  select(-"2023") %>% 
  select(-"...69") %>% 
  select(-"Country Code") %>% 
  select(-"Indicator Code") %>% 
  select(-"Indicator Name")

##import gay travel
gay_2012 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2012.csv", 
                     skip = 1) %>% 
  #dropping to only country rows
  slice(1:145) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(!is.na(Total)) %>% 
  filter(Total != "Total")

gay_2012_cleaned <- gay_2012 %>%
  rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country)) %>% 
  mutate(Year = 2012) %>% 
  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %>% 
  mutate(across(-c(Country), as.numeric))

colnames(gay_2012_cleaned)

gay_2013 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2013.csv", 
                     skip = 1) %>% 
  #dropping to only country rows
  slice(1:145) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(!is.na(Total)) %>% 
  filter(Total != "Total")

gay_2013_cleaned <- gay_2013 %>%
  rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country))  %>% 
  mutate(Year = 2013) %>% 
  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %>% 
  mutate(across(-c(Country), as.numeric))

colnames(gay_2013_cleaned)


gay_2014 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2014.csv", 
                     skip = 1) %>% 
  rename("Country" = "...2") %>% 
  #dropping to only country rows
  #slice(1:145) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2014_cleaned <- gay_2014 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country))  %>% 
  mutate(Year = 2014) %>% 
  rename('Anitdiscrimination' = `Anti-discrimina- tion legislation`) %>% 
  mutate(across(-c(Country), as.numeric))

colnames(gay_2014_cleaned)


gay_2015 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2015.csv", 
                     skip = 1) %>% 
  #rename("Country" = "...2") %>% 
  #dropping to only country rows
  slice(1:210) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2015_cleaned <- gay_2015 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country)) %>% 
  mutate(Year = 2015) %>% 
  rename('Marriage / Partnership' = `Marriage /
Civil Partnership`, 
         "Religious influence" = `Religious Influence`, 
         "Anti-gay laws" = `Anti-Gay Laws`, 
         "HIV-travel restrictions" = `HIV Travel Restrictions`,
         "Anitdiscrimination" = `Antidiscrimination legislation`) %>% 
  mutate(across(-c(Country), as.numeric))

colnames(gay_2015_cleaned)


gay_2016 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2016.csv", 
                     skip = 1) %>% 
  #rename("Country" = "...2") %>% 
  #dropping to only country rows
  slice(1:204) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2016_cleaned <- gay_2016 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country))  %>% 
  mutate(Year = 2016) %>% 
  rename('Marriage / Partnership' = `Marriage /
Civil Partnership`, 
"Religious influence" = `Religious Influence`, 
"Anitdiscrimination" = `Antidiscrimination legislation`, 
"Anti-gay laws" = `Anti-Gay Laws`, 
         "HIV-travel restrictions" = `HIV Travel Restrictions`) %>% 
    mutate(across(-c(Country), as.numeric))


colnames(gay_2016_cleaned)


gay_2017 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2017.csv", 
                     skip = 1) %>% 
  #rename("Country" = "...2") %>% 
  #dropping to only country rows
  slice(1:207) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2017_cleaned <- gay_2017 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country))  %>% 
  mutate(Year = 2017) %>% 
  rename('Marriage / Partnership' = `Marriage /
Civil Partnership`, 
"Religious influence" = `Religious Influence`, 
"Anitdiscrimination" = `Antidiscrimination legislation`, 
"Anti-gay laws" = `Anti-Gay Laws`, 
         "HIV-travel restrictions" = `HIV Travel Restrictions`) %>% 
    mutate(across(-c(Country), as.numeric))


colnames(gay_2017_cleaned)

gay_2018 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2018.csv", 
                     skip = 186) %>% 
  #rename("Country" = "...2") %>% 
  #dropping to only country rows
  #slice(1:230) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2018_cleaned <- gay_2018 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country))  %>% 
  mutate(Year = 2018) %>% 
  rename('Marriage / Partnership' = `Mariage /`, 
         "Equal Age of Consent" = `Equal Age of`, 
         "Homosexuality illegal" = Homosexuality, 
         "Religious influence" = Religious, 
         "Anti-gay laws" = `Anti-Gay Laws`, 
         "HIV-travel restrictions" = `HIV Travel`) %>% 
    mutate(across(-c(Country), as.numeric))

colnames(gay_2018_cleaned)


gay_2019 <- read_csv("/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gaytravelindex_2019.csv") %>% 
  #rename("Country" = "...2") %>% 
  #dropping to only country rows
  #slice(1:230) %>% 
  #dropping empty cols 
  select(-matches("^\\.\\.\\.[0-9]+$")) %>% 
  ##since its was converted from a pdf, at the top of each page it says total, so I need to drop those out going to use the total col as a measure, if it is NA or "Total" indicates its headers
  filter(Total != "Total")

gay_2019_cleaned <- gay_2019 %>%
  #rename('Country' = 'Gay Travel Index') %>% 
  mutate(Country = str_replace(Country, "[0-9]+$", "")) %>% 
  mutate(Country = toupper(Country)) %>% 
  mutate(Year = 2019) %>% 
  rename('Marriage / Partnership' = `Mariage /`, 
         "Equal Age of Consent" = `Equal Age of`, 
         "Homosexuality illegal" = Homosexuality, 
         "Religious influence" = Religious, 
         "Anti-gay laws" = `Anti-Gay Laws`, 
         "HIV-travel restrictions" = `HIV Travel`) %>% 
    mutate(across(-c(Country), as.numeric))

colnames(gay_2019_cleaned)
```

```{r}
#| output: false
#| include: false 
## now lets work on binding the dataframes  

all_yrs_gay <- bind_rows(gay_2012_cleaned,
                         gay_2013_cleaned, 
                         gay_2014_cleaned, 
                         gay_2015_cleaned, 
                         gay_2016_cleaned, 
                         gay_2017_cleaned, 
                         gay_2018_cleaned, 
                         gay_2019_cleaned)

dim(all_yrs_gay)

write.csv(all_yrs_gay, "/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /all_yrs_gay.csv", row.names = FALSE)
```

```{r}
#| include: false 

library(readr)
library(stats) 

all_yrs_gay_pca <- all_yrs_gay %>% 
  select(-c(Total, Country, Year, `Trans Gender Rights`)) %>% 
  na.omit()

# Step 3: Perform PCA
pca_result <- prcomp(all_yrs_gay_pca, scale. = TRUE)

# Print summary of PCA results
summary(pca_result)

# Optional: Plot PCA
plot(pca_result$x[,1:2], pch = 19, xlab = "PC1", ylab = "PC2") + 
title("PCA Plot")

# Scree Plot
plot(pca_result$sdev^2 / sum(pca_result$sdev^2), 
     xlab = "Principal Component", 
     ylab = "Proportion of Variance Explained", 
     type = 'b', 
     pch = 19, 
     main = "Scree Plot")

# Adding a cumulative sum line to the scree plot
cumulative_variance <- cumsum(pca_result$sdev^2 / sum(pca_result$sdev^2))
lines(cumulative_variance, col = "blue", type = 'b', pch = 18)
legend("topright", legend = c("Variance", "Cumulative Variance"), col = c("black", "blue"), pch = c(19, 18), lty = 1)

```

```{r}
#| output: false
#| include: false 

scores <- pca_result$x[, 1:3]
head(scores, 18)

loadings <- pca_result$rotation[, 1:3]
print(loadings)
```

```{r}
#| include: false 
cor_matrix <- cor(all_yrs_gay_pca, use = "pairwise.complete.obs")

# Install and load necessary packages
if (!requireNamespace("igraph", quietly = TRUE)) install.packages("igraph")
if (!requireNamespace("ggraph", quietly = TRUE)) install.packages("ggraph")
library(igraph)
library(ggraph)

graph <- graph_from_adjacency_matrix(cor_matrix, weighted = TRUE, mode = "undirected", diag = FALSE)
threshold <- 0.5  # Example threshold
graph <- delete_edges(graph, E(graph)[abs(E(graph)$weight) < threshold])

# Create the network plot
ggraph(graph, layout = 'fr') + 
  geom_edge_link(aes(edge_alpha = abs(weight), edge_width = abs(weight)), edge_color = "grey") +
  geom_node_point(color = "darkblue", size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_graph() +
  ggtitle("Variable Correlation Network")
```

```{r}
#| output: false
#| include: false 
#lets look for mergining 
tour_dat_cleaned <- tour_dat %>% 
  mutate(Country = toupper(`Country Name`)) %>% 
  select(-`Country Name`)


#lets now check by NA's 
tour_dat_cleaned$NA_count = rowSums(is.na(tour_dat_cleaned[, -which(names(tour_dat_cleaned) == "Country")]))

tour_dat_NA_count = tour_dat_cleaned[, c("Country", "NA_count")] %>% arrange(desc(NA_count))
print(tour_dat_NA_count)

## we know for certain we can drop countries that have 7 or 8 NA's because we cant make any over year effect 
tour_dat_cleaned <- tour_dat_cleaned %>% 
  filter(NA_count < 7) 

dim(tour_dat_cleaned)

write.csv(tour_dat_cleaned, "/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /tour_dat_cleaned.csv", 
          row.names = FALSE)
```

```{r}
#| output: false
#| include: false 
all_yrs_gay_wide <- all_yrs_gay %>% 
  pivot_longer(cols = -c(Country, Year), names_to = "Variable", values_to = "Value") %>%
  unite("Variable_Year", Variable, Year, sep = "_") %>%
  pivot_wider(names_from = "Variable_Year", values_from = "Value") %>% 
  mutate(across(-Country, ~as.numeric(as.character(.))))
  

write.csv(all_yrs_gay_wide, "/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /all_yrs_gay_wide.csv", 
          row.names = FALSE)

dim(all_yrs_gay_wide)
```

```{r}
#| output: false
#| include: false 
tour_dat_new_country_names <- tour_dat_cleaned %>% 
  mutate(Country = case_when(
    Country == "ANTIGUA AND BARBUDA" ~ "ANTIGUA & BARBUDA",
    Country == "BAHAMAS, THE" ~ "BAHAMAS",
    Country == "BOSNIA AND HERZEGOVINA" ~ "BOSNIA-HERZEGOVINA",
    Country == "BRUNEI DARUSSALAM" ~ "BRUNEI",
    Country == "CONGO, DEM. REP." ~ "DEM. REP. OF CONGO",
    Country == "CONGO, REP." ~ "REP. OF THE CONGO",
    Country == "COTE D'IVOIRE" ~ "IVORY COAST",
    Country == "CZECHIA" ~ "CZECH REPUBLIC",
    Country == "EGYPT, ARAB REP." ~ "EGYPT",
    Country == "ESWATINI" ~ "SWAZILAND",
    Country == "IRAN, ISLAMIC REP." ~ "IRAN",
    Country == "KOREA, REP." ~ "KOREA SOUTH",
    Country == "KYRGYZ REPUBLIC" ~ "KYRGYZSTAN",
    Country == "LAO PDR" ~ "LAOS",
    Country == "NORTH MACEDONIA" ~ "MACEDONIA",
    Country == "RUSSIAN FEDERATION" ~ "RUSSIA",
    Country == "SLOVAK REPUBLIC" ~ "SLOVAKIA",
    Country == "SYRIAN ARAB REPUBLIC" ~ "SYRIA",
    Country == "TURKIYE" ~ "TURKEY",
    Country == "VENEZUELA, RB" ~ "VENEZUELA",
    Country == "VIET NAM" ~ "VIETNAM",
    Country == "YEMEN, REP." ~ "YEMEN",
    Country == "UNITED STATES" ~ "USA",
    Country == "MACAO SAR, CHINA" ~ "MACAO", # Assuming direct equivalence
    Country == "ST. KITTS AND NEVIS" ~ "SAINT KITTS & NEVIS",
    Country == "ST. LUCIA" ~ "SAINT LUCIA",
    Country == "ST. VINCENT AND THE GRENADINES" ~ "SAINT VINCENT & THE GRENADINES",
    Country == "GAMBIA, THE" ~ "GAMBIA",
    Country == "COMOROS" ~ "COMOROS ISLANDS",
    Country == "CENTRAL AFRICAN REPUBLIC" ~ "CENTRAL AFRICAN REP.",
    Country == "VIRGIN ISLANDS (USA)" ~ "VIRGIN ISLANDS",
    TRUE ~ Country)) 

```

```{r}
#| output: false
#| include: false 
dataframe <- all_yrs_gay_wide

for(year in 2012:2018) {
  # Generate the names of the columns for the current year and the next year
  current_year_cols <- grep(paste0("_", year, "$"), names(dataframe), value = TRUE)
  next_year_cols <- sub(year, year + 1, current_year_cols)
  
  # For each column corresponding to the current year
  for(i in 1:length(current_year_cols)) {
    current_col <- current_year_cols[i]
    next_col <- next_year_cols[i]
    
    # Check if next_col exists in the dataframe
    if(next_col %in% names(dataframe)) {
      # Adjusting the naming convention as per the new requirement
      change_col_name <- sub("_\\d+$", paste0("__pt.", year + 1), current_col)
      
      # Calculate the additive change and add it as a new column
      dataframe[[change_col_name]] = dataframe[[next_col]] - dataframe[[current_col]]
    }
  }
}

dim(dataframe)


#now select only the vars representing change 
gay_changes_wide <- dataframe %>% 
  select(which(grepl("__", names(dataframe))) | "Country")

dim(gay_changes_wide)

write.csv(gay_changes_wide, "/Users/zachkoung/Library/Mobile Documents/com~apple~CloudDocs/PENN SPRING 24/GLOBAL CONFLICT/Gay Travel /gay_changes_wide.csv", row.names = FALSE)
```

```{r}
#| output: false
#| include: false 
gay_changes_long <- gay_changes_wide %>%
  gather(key = "Year_Variable", value = "Value", -Country) %>%
  mutate(Year = gsub(".*pt\\.(\\d+)", "\\1", Year_Variable),
         Variable = gsub("(.*)__pt\\..*", "\\1", Year_Variable),
         Variable = gsub("_", " ", Variable)) %>%
  select(-Year_Variable) %>%
  spread(key = Variable, value = Value)

dim(gay_changes_long)
```

```{r}
#| output: false
#| include: false 
yrs_to_drop_tour <- as.character(2012:2019)

tour_dat_pct <- tour_dat_new_country_names %>%
  mutate(`2013.pct` = (`2013` - `2012`) / `2012` * 100,
         `2014.pct` = (`2014` - `2013`) / `2013` * 100,
         `2015.pct` = (`2015` - `2014`) / `2014` * 100,
         `2016.pct` = (`2016` - `2015`) / `2015` * 100,
         `2017.pct` = (`2017` - `2016`) / `2016` * 100,
         `2018.pct` = (`2018` - `2017`) / `2017` * 100,
         `2019.pct` = (`2019` - `2018`) / `2018` * 100) %>% 
  select(-all_of(yrs_to_drop_tour)) %>% 
  select(-NA_count)
```

```{r}
#| include: false  
tour_dat_pct_long <- tour_dat_pct %>%
  pivot_longer(
    cols = -Country, 
    names_to = "Year",
    values_to = "tour_pct",
    names_pattern = "(\\d{4}).*")
```

```{r}
#| output: false
#| include: false 
dat_all <- merge(gay_changes_long, tour_dat_pct_long, by=c("Country", "Year"))

#check for duplicates 
duplicates <- dat_all[duplicated(dat_all[c("Country", "Year")]) | duplicated(dat_all[c("Country", "Year")], fromLast = TRUE), ]
print(duplicates)
```

```{r}
#| output: false
#| include: false 
count(dat_all[is.na(dat_all$tour_pct), ]) ##Only 62 instances i feel ok about removing
#print(dat_all[is.na(dat_all$tour_pct), ]) Used to see 
```

```{r}
#| output: false
#| include: false 
dat_all <- dat_all%>% 
  filter(!is.na(tour_pct))
```

```{r}
#| output: false
#| warning: false 
#| include: false 

num_rows_all_NA <- dat_all %>%
  select(-Country, -Year, - tour_pct) %>%  # Exclude non-LGBT variables if necessary
  apply(1, function(x) all(is.na(x))) %>%
  sum()  # Count the number of TRUEs, which indicate rows with all NAs

# Print the total number of rows with all NA for LGBT variables
print(paste("Total number of rows with all LGBT variables as NA:", num_rows_all_NA))

## 202 not ideal but still ok

dat_all_final <- dat_all %>%
  slice(-num_rows_all_NA)
```

```{r}
#| include: false 
ggplot(dat_all_final, 
       aes(x = as.factor(Total), 
           y = tour_pct)) + 
  geom_boxplot() + 
  labs(x = "Total change in LGBTQ+ scores", 
       y = "Change in Tourism Arrivals by Volume", 
       title = "Does changes in LGBTQ friendliness impact tourism volume? No.")
```

```{r}
#| include: false 
ggplot(dat_all_final, 
       aes(x = Total, 
           y = tour_pct)) + 
  geom_point() + 
  geom_smooth(method=lm) + 
  labs(x = "Total change in LGBTQ+ scores", 
       y = "Change in Tourism Arrivals by Volume", 
       title = "Does changes in LGBTQ friendliness impact tourism volume? No.")
```

```{r}
#| output: false
#| include: false 
reg1 <- lm(data = dat_all_final, 
           tour_pct ~ `Total` + 
             `Adoption allowed` + 
             `Anitdiscrimination` + 
             `Anti-gay laws` + 
             `Death sentences` + 
             `Equal Age of Consent` + 
             `HIV-travel restrictions` + 
             `Homosexuality illegal` + 
             `LGBT-Marketing` + 
             `Locals hostile` + 
             `Marriage / Partnership` + 
             `Murders` + 
             `Pride banned` + 
             `Prosecution` + 
             `Religious influence`) #not using transgender bc its missing for so much 
summary(reg1)


reg2 <- lm(data = dat_all_final, 
           tour_pct ~ 
             `Anitdiscrimination` + 
             `Anti-gay laws` + 
             `HIV-travel restrictions` + 
             `Homosexuality illegal` + 
             `LGBT-Marketing` + 
             `Locals hostile` + 
             `Murders` + 
             `Pride banned` + 
             `Prosecution` + 
             `Religious influence`) #not using transgender bc its missing for so much 
summary(reg2)


reg3 <- lm(data = dat_all_final, 
           tour_pct ~ 
            `Pride banned` )#not using transgender bc its missing for so much 
summary(reg3)
```

# **Beyond Borders: Exploring the Impact of LGBT Inclusivity on Global Tourism**

## Introduction 

*Afghanistan. Algeria. Bangladesh. Brunei. Burundi. Cameroon. Chad. Comoros. Dominica. Egypt. Eritrea. Eswatini. Ethiopia. Gambia. Ghana. Grenada. Guinea. Guyana. Iran. Jamaica. Kenya. Kiribati. Kuwait. Lebanon. Liberia. Libya. Malawi. Malaysia. Maldives. Mauritania. Morocco. Myanmar. Namibia. Nigeria. Occupied Palestinian Territory (Gaza Strip). Oman. Pakistan. Papua New Guinea. Qatar. Saint Lucia. Saint Vincent and The Grenadines. Samoa. Saudi Arabia. Senegal. Sierra Leone. Solomon Islands. Somalia. South Sudan. Sri Lanka. Sudan. Syria. Tanzania. Togo. Tonga. Tunisia. Turkmenistan. Tuvalu. Uganda. United Arab Emirates. Uzbekistan. Yemen. Zambia. Zimbabwe.*

There are over 65 countries and territories that actively criminalize homosexuality @HRW2023. 7 punish homosexuality by the death penalty @HRW2023. From the Anti-LGBT 2023 legislation in Uganda @Williams2023Uganda to Iraq's April 2024 legislation further criminalizing homosexuality @PBS2023IraqLaw, many countries in the world are actively regressing on LGBT rights. While some research has been conducted on the economic impacts of LGBT rights for countries, I hope to further consider how anti-LGBT measures effect, specifically, country tourism.

Exploring the intersection of LGBT rights and how the tourism industry makes clear compelling insights into how inclusivity can shape economic landscapes. This research project delves into whether a nation’s commitment to LGBT rights can enhance its appeal as a tourism destination, a concept that holds both economic promise and social significance. This research inquiry is particularly pertinent in light of recent shifts globally and aligns with the broader quest for social equity, epitomized by the United Nations’ Sustainable Development Goal to reduce inequalities @UNSDGs.

Several studies have laid the groundwork for understanding this relationship. Monaco’s investigation into the travel preferences of Italian LGBT Millennials reveals how societal attitudes significantly influence destination choices @monaco2022lgbt. This study highlights the importance of 'push' and 'pull' factors in shaping travel decisions but stops short of linking these behaviors directly to economic outcomes and also focuses specifically on only one tourist demographic: Italian LGBT Millennials. Furthermore, research from the Williams Institute at UCLA @badgett2014relationship presents a macroeconomic view, demonstrating a positive correlation between LGBT inclusivity and economic performance in 39 countries. While these findings suggest that inclusive policies contribute to economic strength, they primarily focus on broad economic indicators rather than specific tourism metrics. The IGLTA Foundation provides valuable demographic and economic data about LGBT travelers, underscoring the economic potential of LGBT friendly tourism practices. The foundation recently released a report to understand how Florida's recent anti-LGBT measures effect its perception as an international tourist destination. They find that nearly half of global survey respondents view Florida as unwelcoming to LGBT individuals and that there is decreased interest in traveling to Florida among the respondents. While this research seeks to understand the relationship between tourism and LGBT measures, it focuses solely on one region and relies on survey data and not economic outcomes @IGLTA2023Report.

Addressing these gaps, my research aims to directly correlate LGBT inclusivity, as measured by an index from the Spartacus Gay Travel Guide @Spartacus2024, with tangible tourism outcomes, specifically tourism volume. Further, I aim to focus on not just one country or region, but rather the entire globe. By employing a quantitative angle, this study seeks to provide a more nuanced understanding of how rights and inclusivity translate into economic benefits for destinations. Through this approach, the research not only substantiates the economic arguments for greater inclusivity but also enhances our comprehension of its broader social ramifications.

## Theory and Hypothesis 

The crux of this research is to scrutinize how the inclusivity of LGBT rights within a country influences its attractiveness as a tourism destination. This idea is anchored in the broader discourse on social equity and economic development, particularly reflecting the objectives outlined in the United Nations' Sustainable Development Goals to reduce inequalities. This study posits a direct, testable hypothesis: **an increase in LGBT friendliness in a country leads to an increase in its tourism volume.**

This hypothesis emerges from a logical synthesis of observed trends and existing literature. Research has repeatedly highlighted that social inclusivity has an effect on economic performance. The Williams Institute (2014) research has demonstrated a positive correlation between LGBT inclusivity and broader economic metrics across multiple countries, @badgett2014relationship.

The expectation that an enhancement in LGBT rights leads to an increase in tourism volume is rooted in several key assumptions. First, individuals actively decide where to travel based on a variety of considerations important to them. Further, one of those considerations, for some travelers, is their values, which could include human rights considerations. Thus, a country perceived as safe and welcoming to LGBT individuals is likely to attract more tourists, especially those from the LGBT community and allies. Put simply, a country that bans *homosexuality*, is unlikely to have travel from lots of *homosexuals* and their friends.

Finally, this hypothesis aligns with the idea of 'voting with your wallet' in a more globalized world. As tourists increasingly seek destinations that reflect their values, countries with progressive LGBT rights not only stand to gain economically but also enhance their global image as inclusive and modern societies. This relationship between enhanced LGBT rights and increased tourism could serve as a pivotal finding for policymakers and business leaders looking to harness the economic potential of inclusive policies.

By rigorously testing this hypothesis through quantitative analysis, this research aims to provide empirical substantiation to the theoretical link between LGBT inclusivity and tourism economics, offering a nuanced understanding of how progressive social policies translate into tangible economic benefits.

## Research Design 

In this section, I will cover the research design of this project. First I will cover some background on the two data sources I am using, as well as discuss some limitations to the data and how I moved forward. Secondly, I will discuss each of the key variables I am using from these data sets, and how they tie into my hypothesis as well as include a few visualizations to help contextualize the some of these variables. Then, I will specify and defend my main regression model to test the hypothesis. I'll also discuss some potential covariates, unobserved cofounders, and other casual concerns that could effect the interpret-ability of the model. In addition to the limitations of the model, I will offer three different empirical extensions that could help further test the model: a region \* independent variable interaction term, adding a time lag of one year between the independent and dependent variables, and creating a new index measure.

#### **Data Sources**

In this research, I am employing two different data sources. In order to asses the dependent/outcome variable, tourism volume, I am utilizing the World Bank's International tourism, number of arrivals measures @world_bank_international_tourist_arrivals. The downloadable data set has data at the country and year level. For example, it has the number of tourist arrivals to the United States in 2014. Note that the data is not perfect, there is some missing data for specific countries and years.

The second data set is the from the Spartacus Gay Travel Guide which publishes yearly reports on each country and variety of different metrics, from whether or not Pride festivals and parades are banned in a given country and year to whether there is HIV-related travel restrictions @Spartacus2024. There are some limitations to this guide, including limited information on the specific methodology employed. They cite a variety of legitimate sources to create the index (including IGLA, Rainbow Europe, the UN, and more), but additional clarity on specific point attributions and more detailed variable explanations could be helpful. Note also that some reports don't include every country and reports sometimes include country and occupied territories as separate entities. In cleaning the data I did my best to keep as many observations as possible and modified the naming where relevant.

Moreover, while the data was relatively complete, I did narrow down the years I would work with. I decided to not use any data starting from January 1, 2020, to remove the issue with COVID-related travel dilemmas. Because the Gay Travel Guide only begins in 2012, the final window is for 2012-2019 and for all countries that existed in both the Gay Travel Guide and the World Bank Travel Data.

#### **Discussion of key variables**

Note that for all of the variables below I have modified them so that it represents the difference from one year to the next for the purpose of the regressions and model.

[Dependent Variable]{.underline}

-   Tourism volume percent change from the previous year (**tour_pct**):

    -   Final unit of analysis is by country and year. Sample is not just countries but also territories (ex: US Virgin Islands), regions (ex: MENA), and other buckets such as income buckets (developing) which I discarded.

[Independent Variables\
]{.underline}*Like tourism, these variables are also the point change (not percent) from one year to the next*

-   **Total**

    -   This represents the total score a country gets in a given year from the Gay Spartacus Travel Index. Each country was scored starting on a variety of different features (see other variables). Scores centered around 0 and countries can either earn points or loose points.

-   **Adoption allowed:** This is a pretty clear measure where its very simple to see whether or not adoption is allowed, and for the most part this functions as a binary variable.

-   **Antidiscrimination:** "With regard to anti-discrimination laws up to 3 points can be awarded, making a distinction, for example, whether the principle of non-discrimination on grounds of sexual orientation in the constitution or only in a law for a specific area is shown." (*direct wording from the GSTI).*

-   **Marriage / Partnership:** is the status on same-sex marriage, partnerships, and unions look like. A higher score indicates that they have gay marriage, lower scores correlate with other forms of relationships or none allowed at all

-   **Equal Age of Consent:** Whether or not the age of consent for homosexual and heterosexual sex is the same (binary).

-   **Religious Influence:** What is the level of religious influence on the country mostly, scores 0 or a negative value (stronger religious influence).

-   **HIV Travel Restrictions :** Is there travel restrictions on those with HIV, binary variable 0 (none) or -1 (restrictions).

-   **Anti-Gay Laws:** Are there laws that are discriminatory to LGB communities, binary variable 0 (none) or -1 (laws).

-   **Homosexuality illegal:** Is homosexuality explicitly criminalized, binary variable 0 (none) or -1 (criminalized).

-   **Pride Banned:** Are Pride celebrations, festivals, or marches banned in the country, binary variable 0 (no ban) or -1 (ban).

-   **Locals Hostile:** Are locals hostile to LGB individuals, 0 (not), and -1 (yes), -2 (yes, greater extent)... so forth.

-   **Prosecution:** Can individuals be prosecuted for being LGB, 0 (not) and negative values for increasing severity.

-   **Murders:** are there murders motivated on sexual orientation or gender identity in the country, binary 0 (none) and -2 (some).

-   **Death Penalty:** "Countries in which the death sentences for homosexuals is enshrined in law but is no longer performed have received one negative point. If people are still executed in a country because of their homosexuality, the country has been given five negative points."

-   **LGBT-Marketing:** Is there specific travel related marketing to LGBT individuals, binary variable 0 (none) or 1 (some).

**Why are these variables important in helping asses the hypothesis?**

These variables and data sources are the most ideal at assessing my hypothesis. The dependent variable, tourism, is accurately measured by the number of arrivals. I chose this over other variables such as dollars spent per visit, average length of visit, size of the tourist economy, or others that did not directly asses the movement of people. Because I hypothesize that people change their tourism plans as a result of LGBT friendliness, using number of people as my unit of analysis is the most apt. Secondly, the independent variables, LGBT friendliness, are also apt at supporting my hypothesis. These variables, including the total score accurately measure LGBT conditions in a given country and connect neatly to my hypothesis.

#### **Visualizations and Contextualization of Variables** 

Because I am taking the difference in both my independent variables, LGBT measures, as well as my dependent variables, **below is a table showcasing some statistics on dependent variables after they have modified to show the change over time.** I decided to showcase it this way as it is more representative of the data I will use in the regressions I will use later.

```{r}
#| echo: false
 
# Recalculate summary statistics for each variable
summary_stats_wide <- dat_all_final %>%
  select(-Country) %>%
  select(-Year) %>% 
  select(-`Trans Gender Rights`) %>% 
  rename("Tourism Percent Change" = tour_pct, 
         "Total LGBTQ+ Friendliness" = Total) %>% 
  summarise(across(
    .cols = c(`Tourism Percent Change`, `Total LGBTQ+ Friendliness`, `Adoption allowed`, 
              Anitdiscrimination, `Anti-gay laws`, `Death sentences`, `Equal Age of Consent`, 
              `HIV-travel restrictions`, 
              `Homosexuality illegal`, `LGBT-Marketing`, `Locals hostile`, `Marriage / Partnership`, 
              Murders, `Pride banned`, Prosecution, `Religious influence`),
    .fns = list(
      min = ~min(., na.rm = TRUE),
      Q1 = ~quantile(., 0.25, na.rm = TRUE),
      median = ~median(., na.rm = TRUE),
      mean = ~mean(., na.rm = TRUE),
      Q3 = ~quantile(., 0.75, na.rm = TRUE),
      Q4 = ~quantile(., 1, na.rm = TRUE),
      max = ~max(., na.rm = TRUE)
    ),
    .names = "{col}_{.fn}"
  )) 
  
summary_stats_wide_round <- summary_stats_wide %>%
  round(1)

# Pivot to wide format properly
summary_stats_wide <- pivot_longer(summary_stats_wide_round, everything(), 
                                   names_to = c("variable", "statistic"), names_sep = "_") %>%
  pivot_wider(names_from = statistic, values_from = value)

# Create a gt table in a wide format FOr some reason GT isnt working
gt_table <- gt(summary_stats_wide) %>%
  tab_header(title = "Summary Statistics for CHANGE in All Variables") %>%
  cols_label(
    variable = "Variable",
    min = "Min",
    Q1 = "Q1",
    median = "Q2",
    mean = "Mean",
    Q3 = "Q3",
    Q4 = "Q4",
    max = "Max"
  )

# Display the table
gt_table
```

As it is evident, because this is looking at the statistics in the change of variables from one year to the next, it does not tell us much on the LGBT side of things, this is because most countries simply do not observe changes from one year to the next and such the mean and median tend to be 0. Given this, I think it could be valuable to just view a chart and graph of just the raw independent (LGBT) variables, not the modified variables (change from the prior year to the next). **These two visualizations** (table and box plot) **just shows the distribution of the raw variables!**

```{r}
#| echo: false
 
# Recalculate summary statistics for each variable
summary_stats_wide_no_change <- all_yrs_gay %>%
  select(-Country) %>%
  select(-Year) %>% 
  select(-`Trans Gender Rights`) %>% 
  rename(
         "Total LGBTQ+ Friendliness" = Total) %>% 
  summarise(across(
    .cols = c( `Total LGBTQ+ Friendliness`, `Adoption allowed`, 
              Anitdiscrimination, `Anti-gay laws`, `Death sentences`, `Equal Age of Consent`, 
              `HIV-travel restrictions`, 
              `Homosexuality illegal`, `LGBT-Marketing`, `Locals hostile`, `Marriage / Partnership`, 
              Murders, `Pride banned`, Prosecution, `Religious influence`),
    .fns = list(
      min = ~min(., na.rm = TRUE),
      Q1 = ~quantile(., 0.25, na.rm = TRUE),
      median = ~median(., na.rm = TRUE),
      mean = ~mean(., na.rm = TRUE),
      Q3 = ~quantile(., 0.75, na.rm = TRUE),
      Q4 = ~quantile(., 1, na.rm = TRUE),
      max = ~max(., na.rm = TRUE)
    ),
    .names = "{col}_{.fn}"
  )) 
  
summary_stats_wide_round_no_change <- summary_stats_wide_no_change %>%
  round(1)

# Pivot to wide format properly
summary_stats_wide_no_change <- pivot_longer(summary_stats_wide_round_no_change, everything(), 
                                   names_to = c("variable", "statistic"), names_sep = "_") %>%
  pivot_wider(names_from = statistic, values_from = value)

# Create a gt table in a wide format
gt_table <- gt(summary_stats_wide_no_change) %>%
  tab_header(title = "Summary Statistics for LGBT Variables 
             (Measuring Raw Score for all Years)") %>%
  cols_label(
    variable = "Variable",
    min = "Min",
    Q1 = "Q1",
    median = "Q2",
    mean = "Mean",
    Q3 = "Q3",
    Q4 = "Q4",
    max = "Max"
  )

# Display the table
gt_table
```

```{r}
#| echo: false
#| warning: false

# Pivot data to long format excluding 'tour_pct'
long_data <- pivot_longer(all_yrs_gay, 
                          cols = c(Total, `Adoption allowed`, Anitdiscrimination, `Anti-gay laws`, 
                                   `Death sentences`, `Equal Age of Consent`, `HIV-travel restrictions`, 
                                   `Homosexuality illegal`, `LGBT-Marketing`, `Locals hostile`, `Marriage / Partnership`, 
                                   Murders, `Pride banned`, Prosecution, `Religious influence`),
                          names_to = "variable", 
                          values_to = "value")

# Boxplot for all other variables horizontally without showing outliers
ggplot(long_data, aes(x = variable, y = value, fill = variable)) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "Visual Representation of LGBT+ Friendliness Variables",
       x = "Variables",
       y = "Raw Values (Not Change)", 
       caption = "Distribution of LGBT+ friendliness metrics across various countries from 2012 to 2019. Each 
       boxplot represents the interquartile range, median, and range of scores for specific variables 
       related to LGBT+ rights and policies. This visualization highlights the variability and general trends 
       in LGBT+ inclusiveness, with the total score being a summative score of the individual 
       components, it cleary demonstrates the most range. Note that  some of these variables are 
       binary and not continous, and thus explains the narrow distribution.")  +
  coord_flip() + 
  scale_y_continuous(breaks = seq(-16, max(long_data$value, na.rm = TRUE), by = 2)) +
  ggthemes::theme_clean()
```

But back on the tourism side, here is a visualization of the change in tourism volume from one year to the next.

```{r, Boxplot for tour_pct horizontally without showing outliers}
#| echo: false
#| warning: false

# Boxplot for 'tour_pct' horizontally without showing outliers
ggplot(dat_all_final, aes(y = tour_pct)) +
  geom_boxplot(outlier.shape = NA) +
  labs(title = "Boxplot of Tourism Volume Percent Change",
       y = "Tourism Volume Percent Change",
       caption = "Distribution of the Percent Change in Tourism across various countries from 2012 and 2019. 
       On average, countries generally experienced a 5% increase in tourism.") +
  scale_y_continuous(limits = c(-25, 25)) + 
  coord_flip() + 
    ggthemes::theme_clean()
```

#### **Main Regression Model:**

$$
Percent\ Change\ Tourism\ Volume_i = \alpha + \beta_1( Change\ in\ LGBT\ Friendliness\ Variables)_{i1} + \epsilon_i
$$

This regression accurately asses my hypothesis, as I would suspect an increase in LGBT friendliness from one year to the next would result in an increase in tourism volume in that same year.

**Discussions of Covariates**

While in the above model, I do not use any potential covariates, the way I cleaned and prepared the data already takes into account one of the biggest potential covariates: size of country's tourist volume. For example, common travel locations, such as Greece, are going to generally just have more travel, even against some similar sized or population sized countries. So its not as much controlling against just the population size, but by using percent change in tourist volume as the outcome, this adjusts for the normal level of travel to a given country more or less applying country fixed effects.

#### **Causal Relationship & Potential Unobserved Cofounders & Limitations** 

A significant challenge to the interpretation of this model is the presence of unobserved confounders that could influence both LGBT policies and tourism volume, such as broader political stability. \
\
For example, lets take a deeper look into political stability—often times political instability results in the claw back of demographic rights. Its entirely possible that far-right or other massive shifts in a countries government are both the cause of changes to LGBT friendliness and changes to the tourist volume.

Additionally, a limitation to the model is that perhaps total score is not an effective at measuring the LGBT factors that matter to tourists. For example, one could argue that adoption rights do not matter to tourists while local hostility and pride celebrations matter more. Adoption rights would likely effect those living in the country but not short term tourists, while some of the specific lgbt variables matter more. As another empirical extension, I will make a new index variable that covers only the LGBT independent variables that I think could matter to tourism. By doing this, it would allow us to have additional certainty on the outcome, because this is not only test another permutation, but this test aligns closer to the intent of the hypothesis, in that it represents the factors that matter to tourists.

Another potential issue with the current model is that it assumes that people are able to quickly adjust their travel plans after changes in LGBT friendliness. It also assumes that people have access to reliable and prompt information covering the change in LGBT friendliness. It could be argued that this turnaround time is simply unrealistic—for example, if people have their travel plans already booked (often times months, if not over a year in advance) and then a country regresses in LGBT friendliness, that they would not or could not change their existing plans, but may not consider that country in the future. This leads to one of the empirical extensions mentioned earlier: employing lagged effects.

#### **Empirical Extensions** 

There are three extensions that I will employ that can help focus the model and interpret ability.

1.  **New Index Variable:** Add an additional index variable that instead of just total score, which is the sum of all the LGBT variables. By creating a new index I could test to see if the variables I suspect would be most important to tourist matters. In this new index I would include are: *Anti-Gay Laws, Homosexuality illegal, Pride Banned, Locals Hostile, Prosecution, Murders, Death Penalty, HIV Travel Restrictions.* Here's why I suspect these factors to matter

    -   **Anti-Gay Laws, Homosexuality illegal, Death Penalty, Prosecution**: Tourists will want to ensure their safety and legal protection while traveling. Countries where homosexuality is criminalized or has specific anti-gay laws pose a higher risk for LGBT travelers and also represent a culture that could be of concerns to tourists that aren't LGBT.

    -   **Pride Banned**: The presence or absence of Pride celebrations can be an indicator of how open and accepting a country is towards the LGBT community, which affects the comfort and experience of tourists. Further, its often that LGBT travelers will travel for these pride celebrations.

    -   **Locals Hostile**: The attitude of local populations towards LGBT individuals can significantly impact a tourist's experience, affecting everything from day-to-day interactions to their overall safety.

    -   **Murders**: The potential for non-state violence based on sexual orientation or gender identity is a critical concern that can deter LGBT tourists from visiting certain destinations. This also could be a concern to non-LGBT tourists as a cultural indicator of a destination.

    -   **HIV Travel Restrictions**: Travelers with HIV (disproportionately effecting the LGBT community) would simply not be able to enter countries with restrictions and thus effect tourism volume.

2.  **Time-Lagged Variables**: I could use lagged values (1 year prior) of the LGBT friendliness measures to examine if changes in LGBT policies impact tourism with a time delay, which would help clarify direction (not that I am particularly concerned about tourism rates impacting LGBT friendliness) and also assuage some of the concerns mentioned earlier.

3.  **Regional Analysis**: Its possible that this trend holds only for certain regions. I'll conduct an additional analysis that looks at an interaction term of region and the independent variable of the main model to account for regional variations in cultural, economic, and political factors that could influence both LGBT rights and tourism independently.

*Note that while these empirical extensions theoretically could be stacked together, and there would be many individual permutations (ex: new index and time lagged, but not region specific; old index, time lagged, and region specific). For the extent of this project, I will employ each of the empirical extensions independently and then also do one extension that stacks all three of the extension (new index + time lag + region) and then also one that stacks only new index and time lag.*

## Findings 

Now that I have discussed the theory and hypothesis as well as the research design, I will now cover the findings from the main regression model.

Before diving into the regression model, I created a visualization to see if I noticed any correlation:

```{r}
#| echo: false
#| warning: false 


#so drop the NA col in plot

plot_of_both <- dat_all_final %>% 
  filter(!is.na(Total))

ggplot(plot_of_both, 
       aes(x = as.factor(`Total`), 
           y = tour_pct)) + 
  geom_boxplot() + 
  labs(x = "Total change in LGBT scores", 
       y = "Change in Tourism Arrivals by Volume", 
       title = "Does changes in LGBT friendliness impact tourism volume? 
       Unlikely.",
       caption = "Considering the impact of a change in LGBTQ+ scores, it looks like there is no effect or 
       relationship on the percent change in tourism. For example, countries that experiences no 
       change in LGBT friendliness on average experienced the same tourism effect as gained 1 or 
       even 2 points to their LGBT score in the last year") + 
  ggthemes::theme_clean() + 
  scale_y_continuous(limits = c(-50, 100))
```

It looks like there is no correlation here between the total change in LGBT score and the percent change in tourism arrivals. This would suggest that we reject my original hypothesis. However, let's also run a regression in the case that this visualization just does not convey the nuance or the effect is just small:

```{r}
#| echo: false 

#now run the main regression and create the first model summary 
model1 <- lm(tour_pct ~ Total, 
             data = dat_all_final)

#summary (model1) p is .77
modelsummary(model1,
             stars = TRUE,  
             title = "Total LGBT Score Change's Effect on Tourism", 
             gof_omit = "IC|Log-Likelihood|F|Deviance")
```

\
In analyzing the results of the regression model where tourism percent change is regressed on the Total score of LGBT friendliness, the estimated coefficient for the LGBT total score is -0.1693. This suggests that for each point increase in the LGBT friendliness score, the tourism percent change decreases by 0.1693 percentage points, this is the opposite of the hypothesized effect. In terms of magnitude, this effect appears quite small.

The model's coefficients reveal that the effect of changes in LGBT scores on tourism volume is **not statistically significant,** as indicated by the p-value of 0.728 for the Total LGBT score coefficient. This implies that changes in LGBT friendliness (as measured by Total) are not be a reliable predictor of changes in tourism volume.

The lack of statistical significance, despite the theoretically reasonable expectation that increased LGBT friendliness could attract more tourists, might be attributable to insufficient statistical power. The data set could have underlying variability that masks any potential effects, or the existing data points may not provide enough evidence to conclusively determine the impact of LGBT friendliness on tourism volumes. Beyond the high p-value, the very low R-squared values (.0001) suggest that the model explains a negligible portion of the variability in tourism changes, which may indicate that other unmodeled factors, such as the the potential unobserved cofounders mentioned earlier, are playing significant roles, or that the model is not specified in a way that captures the complexities of the relationship between LGBT rights and tourism effectively.

**In sum, at least measured by these variables, there is no statistically significant relationship between the change in total LGBT friendliness and change in tourism volume.**

## Empirical Extension Findings

While I did not find a statistically significant relationship in my model, its possible that there is a different case with the empirical extensions being considered. Below is the readout of all the models. First is the original model which is the exact same as the one previously discussed. Second is the model that includes a new index variable instead of the original variable which the prior model includes. Third is the model that includes the original index but adds a time lag (1 year) between the index and the tourism percent change. The fourth model, includes the new index variable and adds a time lag between the index and the tourism percent change. The fifth model incorporates the old index from the first model and and the region interaction term. The final model stacks all three extensions and represents the new index variable and region interaction with a time lag.

```{r}
#| include: false 
#start w model 2 the new index 

new_index_dat <- dat_all_final %>%
  #drop NA's which would be done anyway by reg, also if it has NA for one it does for all so not worries about removing too much data 
  filter(!is.na(`Anti-gay laws`), !is.na(`Homosexuality illegal`), !is.na(`Pride banned`), 
         !is.na(`Death sentences`), !is.na(Prosecution), !is.na(`Locals hostile`), 
         !is.na(Murders), !is.na(`HIV-travel restrictions`)) %>%
  mutate(`Important Factors Index` = `Anti-gay laws` + 
                                        `Homosexuality illegal` +
                                        `Pride banned` + 
                                        `Death sentences` + 
                                        Prosecution + 
                                        `Locals hostile` + 
                                        Murders + 
                                        `HIV-travel restrictions`)

model2 <- lm(tour_pct ~ `Important Factors Index`, 
             data = new_index_dat)

summary(model2)
```

```{r}
#| include: false

#now make model 3 which is time lagged 

time_lagged_dat <- dat_all_final %>% 
  select(Country, Total, Year, tour_pct) %>% 
  filter(!is.na(Total)) %>% 
  arrange(Country, Year) %>%
  group_by(Country) %>%
  mutate(lagged_tour_pct = lead(tour_pct, 1)) %>%
  ungroup()

model3 <- lm(lagged_tour_pct ~ Total,
             data = time_lagged_dat)

summary(model3) #wow p-val is quite low! 
```

```{r}
#| include: false
new_index_dat_time_lag <- new_index_dat %>%
  filter(!is.na(Total)) %>% 
  arrange(Country, Year) %>%
  group_by(Country) %>%
  mutate(lagged_tour_pct = lead(tour_pct, 1)) %>%
  ungroup() %>% 
  filter(!is.na(lagged_tour_pct))

model3a <- lm(lagged_tour_pct ~ `Important Factors Index`,
             data = new_index_dat_time_lag)

summary(model3a)

```

```{r}
#| include: false

#just for curiosity, lets see a cor plot

selected_vars <- new_index_dat_time_lag[, c('HIV-travel restrictions', 'Pride banned', 'Murders', 
                                            'Prosecution', 'Anti-gay laws', 'Homosexuality illegal', 
                                            'Locals hostile', 'Death sentences', 'lagged_tour_pct')]

# Compute the correlation matrix
cor_matrix <- round(cor(selected_vars, use = "complete.obs"), 2)

cor_matrix
```

```{r}
#| include: false


#model 4, region analysis. 
#first get unqique contries so I can sort 
#unique(dat_all_final$Country)

regions_dat_final <- dat_all_final %>%
  mutate(Region = case_when(
       Country %in% c("ANTIGUA & BARBUDA", "PUERTO RICO", "ARGENTINA", "BARBADOS", "BELIZE", "BOLIVIA", "BRAZIL", "CANADA", 
                   "CHILE", "COLOMBIA", "COSTA RICA", "CUBA", "DOMINICA", "DOMINICAN REPUBLIC", "ECUADOR",
                   "EL SALVADOR", "GRENADA", "GUATEMALA", "GUYANA", "HAITI", "HONDURAS", "JAMAICA", "MEXICO",
                   "NICARAGUA", "PANAMA", "PARAGUAY", "PERU", "SAINT KITTS & NEVIS", "SAINT VINCENT & THE GRENADINES",
                   "SURINAME", "TRINIDAD & TOBAGO", "UNITED STATES", "URUGUAY", "VENEZUELA", "ARUBA", "BAHAMAS", "BERMUDA", "BRITISH VIRGIN ISLANDS", "CURACAO", "USA", "DOMINICAN REPUBLIC") ~ "Americas & Caribbean",

    Country %in% c("AUSTRALIA", "CAMBODIA", "CHINA", "FIJI", "INDONESIA", "KIRIBATI", "KOREA SOUTH", "JAPAN",
                   "LAOS", "MALAYSIA", "MARSHALL ISLANDS", "MONGOLIA", "MYANMAR", "NEW ZEALAND", "PALAU",
                   "PAPUA NEW GUINEA", "PHILIPPINES", "SAMOA", "SINGAPORE", "SOLOMON ISLANDS", "THAILAND",
                   "TIMOR-LESTE", "TONGA", "VANUATU", "VIETNAM", "BRUNEI", "MACAO") ~ "East Asia & Pacific",

    Country %in% c("ALBANIA", "ARMENIA", "AZERBAIJAN", "BELARUS", "BOSNIA-HERZEGOVINA", "BULGARIA", "CROATIA",
                   "CYPRUS", "CZECH REPUBLIC", "ESTONIA", "GEORGIA", "HUNGARY", "KAZAKHSTAN", "KYRGYZSTAN",
                   "LATVIA", "LITHUANIA", "MOLDOVA", "POLAND", "ROMANIA", "RUSSIA", "SERBIA", "SLOVAKIA",
                   "SLOVENIA", "TAJIKISTAN", "TURKEY", "TURKMENISTAN", "UKRAINE", "UZBEKISTAN", "AUSTRIA", "MACEDONIA") ~ "Eastern Europe and Central Asia",

    Country %in% c("ALGERIA", "BAHRAIN", "DJIBOUTI", "EGYPT", "IRAN", "IRAQ", "ISRAEL", "JORDAN", "KUWAIT",
                   "LEBANON", "LIBYA", "MALTA", "MOROCCO", "OMAN", "QATAR", "SAUDI ARABIA", "SYRIA", "TUNISIA",
                   "UNITED ARAB EMIRATES", "YEMEN") ~ "Middle East and North Africa",

    Country %in% c("AFGHANISTAN", "BANGLADESH", "BHUTAN", "INDIA", "MALDIVES", "NEPAL", "PAKISTAN", "SRI LANKA") ~ "South Asia",

    Country %in% c("ANGOLA", "BENIN", "BOTSWANA", "BURKINA FASO", "BURUNDI", "CAMEROON", "CAPE VERDE",
                   "CENTRAL AFRICAN REP.", "CHAD", "COMOROS", "DEMOCRATIC REPUBLIC OF CONGO", "REPUBLIC OF CONGO",
                   "CÔTE D'IVOIRE", "EQUATORIAL GUINEA", "ERITREA", "ETHIOPIA", "GABON", "THE GAMBIA", "GHANA",
                   "GUINEA", "GUINEA-BISSAU", "KENYA", "LESOTHO", "LIBERIA", "MADAGASCAR", "MALAWI", "MAURITANIA",
                   "MAURITIUS", "MOZAMBIQUE", "NAMIBIA", "NIGER", "NIGERIA", "RWANDA", "SÃO TOMÉ AND PRÍNCIPE", "SENEGAL",
                   "SEYCHELLES", "SIERRA LEONE", "SOMALIA", "SOUTH AFRICA", "SUDAN", "SWAZILAND", "TANZANIA", "TOGO","MALI", "REP. OF THE CONGO", 
                   "UGANDA", "ZAMBIA", "ZIMBABWE", "CABO VERDE", "	
COMOROS ISLANDS", "DEM. REP. OF CONGO", "GAMBIA", "IVORY COAST", "COMOROS ISLANDS") ~ "Sub-Saharan Africa",

    Country %in% c("ALBANIA", "BELGIUM", "DENMARK", "FINLAND", "FRANCE", "GERMANY", "GREECE", "ICELAND", "ITALY",
                   "IRELAND", "LUXEMBOURG", "NETHERLANDS", "NORWAY", "PORTUGAL", "SPAIN", "SWEDEN", "SWITZERLAND", "SAN MARINO", 
                   "UNITED KINGDOM", "ANDORRA", "LIECHTENSTEIN", "MONACO", "MONTENEGRO") ~ "Western Europe",

    TRUE ~ "Unknown"
    )) 

regions_dat_final$Region <- as.factor(regions_dat_final$Region)

model4 <- lm(tour_pct ~ Total*Region, 
             data = regions_dat_final)

summary(model4)

```

```{r}
#| include: false

#model 5 stack all 

new_index_time_lag_region_dat <- new_index_dat_time_lag %>% 
   mutate(Region = case_when(
       Country %in% c("ANTIGUA & BARBUDA", "PUERTO RICO", "ARGENTINA", "BARBADOS", "BELIZE", "BOLIVIA", "BRAZIL", "CANADA", 
                   "CHILE", "COLOMBIA", "COSTA RICA", "CUBA", "DOMINICA", "DOMINICAN REPUBLIC", "ECUADOR",
                   "EL SALVADOR", "GRENADA", "GUATEMALA", "GUYANA", "HAITI", "HONDURAS", "JAMAICA", "MEXICO",
                   "NICARAGUA", "PANAMA", "PARAGUAY", "PERU", "SAINT KITTS & NEVIS", "SAINT VINCENT & THE GRENADINES",
                   "SURINAME", "TRINIDAD & TOBAGO", "UNITED STATES", "URUGUAY", "VENEZUELA", "ARUBA", "BAHAMAS", "BERMUDA", "BRITISH VIRGIN ISLANDS", "CURACAO", "USA", "DOMINICAN REPUBLIC") ~ "Americas & Caribbean",

    Country %in% c("AUSTRALIA", "CAMBODIA", "CHINA", "FIJI", "INDONESIA", "KIRIBATI", "KOREA SOUTH", "JAPAN",
                   "LAOS", "MALAYSIA", "MARSHALL ISLANDS", "MONGOLIA", "MYANMAR", "NEW ZEALAND", "PALAU",
                   "PAPUA NEW GUINEA", "PHILIPPINES", "SAMOA", "SINGAPORE", "SOLOMON ISLANDS", "THAILAND",
                   "TIMOR-LESTE", "TONGA", "VANUATU", "VIETNAM", "BRUNEI", "MACAO") ~ "East Asia & Pacific",

    Country %in% c("ALBANIA", "ARMENIA", "AZERBAIJAN", "BELARUS", "BOSNIA-HERZEGOVINA", "BULGARIA", "CROATIA",
                   "CYPRUS", "CZECH REPUBLIC", "ESTONIA", "GEORGIA", "HUNGARY", "KAZAKHSTAN", "KYRGYZSTAN",
                   "LATVIA", "LITHUANIA", "MOLDOVA", "POLAND", "ROMANIA", "RUSSIA", "SERBIA", "SLOVAKIA",
                   "SLOVENIA", "TAJIKISTAN", "TURKEY", "TURKMENISTAN", "UKRAINE", "UZBEKISTAN", "AUSTRIA", "MACEDONIA") ~ "Eastern Europe and Central Asia",

    Country %in% c("ALGERIA", "BAHRAIN", "DJIBOUTI", "EGYPT", "IRAN", "IRAQ", "ISRAEL", "JORDAN", "KUWAIT",
                   "LEBANON", "LIBYA", "MALTA", "MOROCCO", "OMAN", "QATAR", "SAUDI ARABIA", "SYRIA", "TUNISIA",
                   "UNITED ARAB EMIRATES", "YEMEN") ~ "Middle East and North Africa",

    Country %in% c("AFGHANISTAN", "BANGLADESH", "BHUTAN", "INDIA", "MALDIVES", "NEPAL", "PAKISTAN", "SRI LANKA") ~ "South Asia",

    Country %in% c("ANGOLA", "BENIN", "BOTSWANA", "BURKINA FASO", "BURUNDI", "CAMEROON", "CAPE VERDE",
                   "CENTRAL AFRICAN REP.", "CHAD", "COMOROS", "DEMOCRATIC REPUBLIC OF CONGO", "REPUBLIC OF CONGO",
                   "CÔTE D'IVOIRE", "EQUATORIAL GUINEA", "ERITREA", "ETHIOPIA", "GABON", "THE GAMBIA", "GHANA",
                   "GUINEA", "GUINEA-BISSAU", "KENYA", "LESOTHO", "LIBERIA", "MADAGASCAR", "MALAWI", "MAURITANIA",
                   "MAURITIUS", "MOZAMBIQUE", "NAMIBIA", "NIGER", "NIGERIA", "RWANDA", "SÃO TOMÉ AND PRÍNCIPE", "SENEGAL",
                   "SEYCHELLES", "SIERRA LEONE", "SOMALIA", "SOUTH AFRICA", "SUDAN", "SWAZILAND", "TANZANIA", "TOGO","MALI", "REP. OF THE CONGO", 
                   "UGANDA", "ZAMBIA", "ZIMBABWE", "CABO VERDE", "	
COMOROS ISLANDS", "DEM. REP. OF CONGO", "GAMBIA", "IVORY COAST", "COMOROS ISLANDS") ~ "Sub-Saharan Africa",

    Country %in% c("ALBANIA", "BELGIUM", "DENMARK", "FINLAND", "FRANCE", "GERMANY", "GREECE", "ICELAND", "ITALY",
                   "IRELAND", "LUXEMBOURG", "NETHERLANDS", "NORWAY", "PORTUGAL", "SPAIN", "SWEDEN", "SWITZERLAND", "SAN MARINO", 
                   "UNITED KINGDOM", "ANDORRA", "LIECHTENSTEIN", "MONACO", "MONTENEGRO") ~ "Western Europe",

    TRUE ~ "Unknown"
    )) 
  
new_index_time_lag_region_dat$Region <- as.factor(new_index_time_lag_region_dat$Region)

model5 <- lm(tour_pct ~ `Important Factors Index`*Region, 
             data = new_index_time_lag_region_dat)

summary(model5)
```

```{r}
#| echo: false 

##make all the alternative models 
  # #basic model 
  # model1,
  # #new index 
  # model2,
  # #time lagged 
  # model3, 
  # #time lag + new index 
  # model3a, 
  # #region analysis 
  # model4, 
  # #stacked all three emp. extensions
  # model5)

modelsummary(list("Orginal Model"=model1, 
                  "New Index Variable Model"=model2, 
                  "Time Lagged Model"=model3, 
                  "New Index Variale & Time Lagged Model"=model3a, 
                  "Original Model with Region Interaction Model"=model4, 
                  "New Index Variable & Time Lagged & Region Interaction Model"=model5),
             stars = TRUE,  
             title = "Various Regression Models Assesing LGBT Friendliness and Tourism Volume", 
             gof_omit = "IC|Log-Likelihood|F|Deviance")
```

#### **Interpretation** 

**Model 2: New Index Variable Model**

In this model, I found that as the new index factor increases by one unit, the change in percent of tourism is a decrease of 0.368% which is a stronger effect that the first model, suggesting that these variables are critical. Note also this is in the same direction of the model 1, also suggesting a rejection of my hypothesis. However, this is not a statistically significant, and suffers some of the same caveats and concerns laid out in the interpretation of model 1. This model speaks to the fact it is unlikely that there is a genuine relationship between the change in LGBT friendliness and the change in tourism volume.

**Model 3: Time Lagged Model**

In this model, I found that as the original Total LGBT score increases by one unit, the change in percent of tourism is a decrease of 0.752% which is a stronger effect than both of the new index variable and the original model, which may suggest that there is validity to the use of a time lag. Note also this is in the same direction of the model 1, also suggesting a rejection of my hypothesis. However, it does not reach the threshold for statistical significance and thus further reduces the likelihood between a genuine relationship between the change in LGBT friendliness and change in tourism volume.

**Model 4: New Index Variable + Time Lagged Model**

In this model, I came the closest to a statistically significant solution. I find that an increase in the new index variable by one unit, results in a decrease of tourism by 1.348% . However, the p-value at .06 is still greater than the .05 required for statistical significance. This model, unlike the prior few, indicate that there could be a genuine relationship given the closeness to statistical significance; however the direction is also negative, opposite of the hypothesis, making it strong evidence to reject the hypothesis.

**Model 5: Original Index + Region Interaction Term Model**

*Intercept Coefficient (-0.2083 for Total):* Represents the impact of the LGBT score change on tourism percent change in the baseline region, America's and the Caribbean. This coefficient suggests a slight decrease in tourism growth for each unit increase in the LGBT score; however, this effect is not statistically significant (p = 0.8165), indicating that within this region, the LGBT score changes do not significantly influence tourism changes.

*Region-Specific Coefficients:* The coefficient for South Asia (+10.5666) indicates a substantial and statistically significant positive effect on tourism percent change, suggesting that South Asia experiences a significantly higher baseline level of tourism growth compared to the baseline region. This effect is prominent and independent of the LGBT score changes. Similarly, East Asia & Pacific and Eastern Europe and Central Asia also exhibit positive effects, albeit these are not related to the interaction with the LGBT score changes.

*Interaction Terms (Total:RegionX):* These terms attempt to quantify the differential impact of the LGBT score changes across different regions compared to the baseline. For instance, the interaction term for RegionSouth Asia with Total is negative (-1.1588) but not statistically significant (p = 0.6099), implying that while the initial impact of the score changes in South Asia suggests a negative trend, it does not significantly differ from the baseline region's trend. Other regions also show no significant interactions, which might indicate either a lack of statistical power or the possibility that these interaction effects are overshadowed by other unmodeled factors.

The regions exhibit different baseline levels of tourism growth, yet none of the interaction terms across regions show statistical significance. This consistency across various regions indicates that the idea that changes in LGBT scores influence tourism differently in different regions — does not hold under the current model settings.

**Model 6: New Index Variable & Time Lagged & Region Interaction Model**

*(Intercept) Coefficient (4.4046):* This represents the estimated change in tourism percentage for the baseline region (America's and Caribbean) when the Important Factors Index is zero.

*Important Factors Index Coefficient (-0.5986):* This coefficient suggests that in the baseline region, an increase in the "Important Factors Index" is associated with a decrease in tourism percentage change. However, this effect is not statistically significant (p = 0.6573), indicating that the index alone does not predict tourism changes effectively in the America's and Caribbean region.

*Region-Specific Coefficients:* Positive significant effects are observed for East Asia & Pacific, Eastern Europe, and Central Asia indicating these regions start with a higher baseline tourism change compared to the America's and Caribbean regions

*Interaction Terms (Important Factors Index:RegionX):* These coefficients essentially show the effect of the relationship (new LGBT index variable on the tourism variable) in the specific region; however, none of the interaction terms are statistically significant, suggesting that the effect of the "Important Factors Index" does not vary significantly across different regions compared to the baseline.

By doing regional specific analysis, it examines the potential moderating effects of regional characteristics on general trends observed globally. However, like model 5, this model further reduces support for the relationship between these two concepts as nothing was statistically significant.

------------------------------------------------------------------------

While ultimately I did not find the relationships that I wanted to, all of these 5 additional models provide support for the rejection of the hypothesis and the idea that there is a relationship between changes in LGBT friendliness and changes in country tourism. Not a single model permutation had a statistically significant effect; however model 4 was close with a p-value of .06.

```{r}
#| echo: false
#| warning: false

##Make plot of model 4 

model4_plot <- new_index_dat_time_lag %>% 
  filter(!is.na(`Important Factors Index`))

ggplot(model4_plot, 
       aes(x = as.factor(`Important Factors Index`), 
           y = tour_pct)) + 
  geom_boxplot() + 
  labs(x = "Total change in Important LGBT Factors", 
       y = "Change in Tourism Arrivals by Volume", 
       title = "Does changes in specific and important LGBT factors impact 
       tourism volume? Likely not.",
       caption = "Considering the impact of a change in this new index variable, it looks like there is no effect or 
       relationship on the percent change in tourism. So while the p-value is close to signifcant, visually, 
       there does not appear to be a trend") + 
    ggthemes::theme_clean() + 
  scale_y_continuous(limits = c(-50, 100))
```

## Discussion and Policy Implications 

My analysis revealed that changes in LGBT friendliness (at least, as measured by the Spartacus Gay Travel Guide's index) did not statistically significantly affect tourism volume. This was consistent across 6 different model variations, including those incorporating regional interactions and time-lagged variables. Again: none of the models demonstrated a statistically significant relationship that would support the hypothesis that increased LGBT rights and inclusivity boost tourism. However, no model proved a statistically significant relationship of increases LGBT friendliness decreasing tourist volume.

These results suggest that while socially progressive policies towards LGBT communities are morally and ethically significant, they may not directly translate into increased tourism traffic as hypothesized. This could be due to several factors including but not limited to: tourists might prioritize other factors such as cost, climate, geographic proximity, and historical attractions over social policies when choosing destinations, the number of tourists that do prioritize social values is simply dwarfed by those who do not, or the current metrics used to quantify LGBT friendliness might not capture the aspects of inclusivity that potential tourists value most.

Although the direct economic benefit of enhanced LGBT inclusivity in boosting tourism wasn't substantiated in this study, this does not diminish the value of inclusive LGBT policies. The moral and ethical drive for rights and equality remains clear, and such policies may still indirectly benefit economies as prior research has already pointed out. It's hard to support any other policy recommendations, given the lack of any statistical significance; however,

To build on the findings of this research and address some of its limitations, several avenues for future research can be considered: including broader and other measures of economic impact, more qualitative or mixed method studies aimed at further understanding tourism choices, repeating this research in the years since 2020 as its possible LGBT-friendliness has become more salient overtime, using different sources of data to better capture LGBT-friendliness.

In sum, while my research did not find evidence to support the hypothesis that increased LGBT inclusivity boosts (or harms) tourism, it underscores the need for continued research into the broader implications of LGBT friendliness on economic outcomes. The lack of a significant finding also highlights the importance of furthering LGBT rights for intrinsic reasons rather than just economic benefits.
